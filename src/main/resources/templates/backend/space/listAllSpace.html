<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AJAX GET 範例 - Fetch 版</title>
</head>
<body>
  <h2>查詢單一空間</h2>
  <input type="text" id="spaceIdInput" placeholder="請輸入空間 ID">
  <button onclick="getSpaceById()">查詢</button>

  <ul id="userList"></ul>
  <div id="singleSpaceResult"></div>

  <script>
    function getAllSpaces() {
      fetch("http://localhost:8080/spaces")
        .then(function(response) {
          if (!response.ok) {
            throw new Error("HTTP 錯誤，狀態碼：" + response.status);
          }
          return response.json();
        })
        .then(function(spaces) {
          var userList = document.getElementById("userList");
          userList.innerHTML = "";

          spaces.forEach(function(space) {
            var li = document.createElement("li");
            li.textContent = space.name + " (ID: " + space.id + ")";
            userList.appendChild(li);
          });
        })
        .catch(function(error) {
          console.error("錯誤發生：", error);
        });
    }
    getAllSpaces();

    function getSpaceById() {
      var spaceId = document.getElementById("spaceIdInput").value;
      if (!spaceId) {
        alert("請輸入空間 ID");
        return;
      }

      fetch(`http://localhost:8080/spaces/id/${spaceId}`)
        .then(function(response) {
          if (!response.ok) {
            throw new Error("查無此空間 (狀態碼：" + response.status + ")");
          }
          return response.json();
        })
        .then(function(space) {
          var resultDiv = document.getElementById("singleSpaceResult");
          resultDiv.innerHTML = `<p><strong>空間名稱：</strong> ${space.name} <br><strong>ID：</strong> ${space.id}</p>`;
        })
        .catch(function(error) {
          var resultDiv = document.getElementById("singleSpaceResult");
          resultDiv.innerHTML = `<p style="color:red;">${error.message}</p>`;
        });
    }
  </script>
</body>
</html>
